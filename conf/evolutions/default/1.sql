# --- !Ups

CREATE TABLE EXPENSES (
  id BIGSERIAL NOT NULL PRIMARY KEY,
  description CHARACTER VARYING(255),
  price NUMERIC(7,2),
  purchase_date DATE,
  location CHARACTER VARYING(32)
);

CREATE TABLE USERS(
  id CHARACTER VARYING NOT NULL PRIMARY KEY,
  first_name CHARACTER VARYING(255),
  last_name CHARACTER VARYING(255),
  email CHARACTER VARYING(255),
  activated BOOLEAN DEFAULT FALSE,
  avatar_url CHARACTER VARYING
);

CREATE TABLE AUTH_TOKENS (
  id CHARACTER VARYING PRIMARY KEY,
  user_id CHARACTER VARYING NOT NULL,
  expiry CHARACTER VARYING
);

CREATE TABLE LOGIN_INFO (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
  provider_id CHARACTER VARYING(255) NOT NULL,
  provider_key CHARACTER VARYING(255) NOT NULL
);

CREATE TABLE USER_LOGIN_INFO (
  user_id CHARACTER VARYING NOT NULL,
  login_info_id BIGINT NOT NULL
);

CREATE TABLE PASSWORD_INFO (
  HASHER CHARACTER VARYING(255) NOT NULL,
  PASSWORD CHARACTER VARYING(255) NOT NULL,
  SALT CHARACTER VARYING(255),
  LOGIN_INFO_ID BIGINT NOT NULL
);

CREATE TABLE OAUTH1_INFO (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
  TOKEN CHARACTER VARYING NOT NULL,
  SECRET CHARACTER VARYING NOT NULL,
  LOGIN_INFO_ID BIGINT NOT NULL
);

CREATE TABLE OAUTH2_INFO (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
  ACCESS_TOKEN CHARACTER VARYING NOT NULL,
  TOKEN_TYPE VARCHAR,
  EXPIRES_IN INTEGER,
  REFRESH_TOKEN CHARACTER VARYING,
  LOGIN_INFO_ID BIGINT NOT NULL
);


# --- !Downs

DROP TABLE OAUTH2_INFO;
DROP TABLE OAUTH1_INFO;
DROP TABLE PASSWORD_INFO;
DROP TABLE USER_LOGIN_INFO;
DROP TABLE LOGIN_INFO;
DROP TABLE USERS;
DROP TABLE AUTH_TOKENS
DROP TABLE EXPENSES;